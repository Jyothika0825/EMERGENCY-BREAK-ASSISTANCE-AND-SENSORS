#include "sensor.h"
#include "brake_system.h"
#include "config.h"

UltrasonicSensor sensor;
BrakeSystem brake;

void setup() {
    Serial.begin(9600);
    Serial.println("Emergency Brake Assistance System Initialized");
}

void loop() {

    int distance = sensor.getDistance();

    Serial.print("Distance: ");
    Serial.print(distance);
    Serial.println(" cm");

    if (distance > SAFE_DISTANCE) {
        brake.safeMode();
    }
    else if (distance <= SAFE_DISTANCE && distance > WARNING_DISTANCE) {
        brake.warningMode();
    }
    else if (distance <= CRITICAL_DISTANCE) {
        brake.emergencyBrake();
    }

    delay(200);
}